<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <script src="src/roslib.js"></script>
  <script>
    var ros;

    function initRos() {
      var my_ip = "192.168.0.45";

      // Connect to the proxy server instead of the ROS server directly
      ros = new ROSLIB.Ros();

      ros.on('error', function (error) {
        console.log('Error connecting to ROS: ', error);
      });

      ros.on('connection', function () {
        console.log('Connected to ROS');
      });

      ros.on('close', function () {
        console.log('Connection to ROS closed');
      });

      ros.connect('ws://' + my_ip + ':8080');

      // Subscribing to a Topic
      var listener = new ROSLIB.Topic({
        ros: ros,
        name: '/listener',
        messageType: 'std_msgs/String'
      });

      // Then we add a callback to be called every time a message is published on this topic.
      listener.subscribe(function (message) {
        document.write(message.data);
        console.log('Received message on ' + listener.name + ': ' + message.data);
      });
    }

    // Call the function to initialize ROS when the page is loaded
    window.onload = initRos;
  </script>
</head>
<body>
  <h1>Simple roslib Example</h1>
  <p>Run the following commands in the terminal then refresh this page. Check the JavaScript console for the output.</p>
</body>
</html>
